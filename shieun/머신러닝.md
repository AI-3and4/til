# 머신러닝1

## 머신러닝

### 머신러닝 개념

데이터가 다음과 같을 때

| x | y |
| --- | --- |
| 1 | 3 |
| 2 | 5 |
| 3 | 7 |
| 4 | 9 |

x: 5 인 경우 y의 값이 얼마일까?

기계는 데이터를 기반으로 x와 y 사이의 관계를 파악하여 y가 11이라는 결과를 도출한다.

이러한 과정을 **머신러닝**이라고 함

### 학습 방법에 따른 분류

- 지도 학습 : 정답이 있는 데이터를 기반으로 규칙성(패턴)을 배우게 하는 학습 방법
- 비지도 학습 : 정답이 없는 데이터만으로 배우게 하는 학습 방법
- 강화 학습 : 게임과 같이 선택한 결과에 따라 보상을 받아 행동을 개선하며 배우게 하는 학습 방법

### 과제에 따른 분류

- 분류 문제 : 학습을 통해 찾은 규칙을 기반으로 새로운 데이터를 분류함(지도 학습)
- 회귀 문제 : 학습을 통해 찾은 값의 연관성을 기반으로 새롭게 주어진 데이터에 대한 값을 예측(지도 학습)
- 클러스터링 : 학습을 통해 찾은 분류 규칙을 찾고 새로운 데이터를 분류함- 정답이 없어 성능 평가가 어려움(비지도 학습)

## 분류와 회귀

- 분류 : 범주값 예측 ex) 이동 여부, 교체 여부
- 회귀 : 숫자값 예측 - 중간값이 의미가 있는지, 연산 결과가 의미 있는지… 로 확인 가능 ex) 주가예측, 수요량 예측

분류와 회귀는 서로 다른 함수를 사용하여 모델링 함

→ **문제유형을 정확히 파악**하여 **알고리즘과 평가 방법을 선택**한 후 **관련 함수를 사용해 모델링**해야 함

<aside>
💡

분류 모델로 학습한다면 평가 또한 분류 문제 평가 방법으로 진행해야 함 !!

예측 모델로 학습한다면 평가 또한 예측 문제 평가 방법으로 진행해야 함 !!

</aside>

## 용어 정리

- 모델 : 데이터로부터 패턴을 찾아 수학식으로 정리하는 것
    - 모델링 : 오차가 적은 모델을 만드는 과정
    - 샘플을 가지고 전체를 추정함
        - 샘플 : 표본, 부분집합, 일부, 과거 데이터
        - 전체 : 모집단, 전체집합, 현재와 미래 데이터
        - 추정 : 예측, 추론
- 열 : 특성(feature), 속성(attribute), **변수**(variable), 필드(field)
- 행 : 개체(instance), **관측치**(observed value), 기록(record), 사례(example), 경우(case)
- 독립변수 : 원인(x)
- 종속변수 : 결과(y)
- 평균 : 가장 단순한 모델 - 회귀모델은 평균보다 더 오차가 적은 모델을 만들고 싶어함
- 분류모델의 경우 최반값, 최반값보다 더 오차가 적은 모델을 만들고 싶어함
- 오차 : 실제값과 모델 예측값의 차이, 이탈도
- 데이터 분리 : 데이터 셋을 학습용, 검증용, 평가용 데이터로 분리하여 사용함
- 과대적합 : 학습 데이터에만 성능이 좋은 모델, 평가 데이터에서는 성능이 좋지 않음
- 과소적합 : 학습 데이터와 평가 데이터 모두 성능이 안좋거나, 학습데이터보다 평가 데이터에서 성능이 좋은 경우를 말함

## 실습 : 전처리

- 라이브러리, 데이터 불러오기
    - import 모듈
    - pd.read_csv()를 이용하여 데이터 읽어오기
- 불필요한 변수 제거
    - data.drop(columns=, inplace=True) 를 이용하여 불필요한 열 제거
- NaN 조치
    - NaN 제거
        - data.isna().sum()으로 NaN 개수 확인
        - data.dropna(axis=0, inplace=True) NaN이 포함된 모든 행 제거
        - data.dropna(subset=[’column’], axis =0. inplace=True) column열에 NaN이 포함된 행 제거
        - data.dropna(axis=1, inplace=True) NaN이 포함된 모든 열 제거
    - NaN 채우기
        - 평균값 : data[’column’].fillna(data[’column’].mean(), inplace=True)
        - 최빈값 : data[’column’].value_counts(dropna=True) → data[’column’].fillna('최빈값', inplace=True)
    - 앞/뒤 값으로 채우기
        - 앞의 값으로 채우기 : data[’column’].ffill()
        - 뒤의 값으로 채우기 : data[’column’].bfill()
- 가변수화
    - one-hot encoding을 진행하는 과정 → 변수간 비교우위가 없는데, 컴퓨터가 오해할 수도 있어서 명확하게 변환하는 과정
    - pd.get_dummies이용 : pd.get_dummies(data, columns=[’’,’’, ..], drop_first=True, dtype=int)

## 모델링

### Scikit-Learn

- 지도/비지도 학습 알고리즘을 제공하는 파이썬 라이브러리로 사이킷런이라고 부름
- 모델링 코드 구조
    1. 불러오기 - import
    2. 선언하기 - model = (사용 알고리즘명())
    3. 학습하기 - model.fit(x_train, y_train)
    4. 예측하기 - model.predict(x_test)
    5. 평가하기 - 실제값과 예측값을 평가 함수에 전달하여 성능 평가

### 데이터 준비

- 입력된 데이터에서 찾은 규칙을 기반으로 예측하는 것이므로 좋은 데이터가 좋은 모델을 만듦
- 데이터를 충분히 분석하고 전처리한 후 데이터 분리해야 함

## 실습 : 데이터 분할, 모델링

- 학습용, 평가용 데이터 분할
    - sklearn.model_selection의 train_test_split을 이용
    - 0.3 비율로 나누기 위해 test_size 설정, 동일 결과를 위해 random_state 설정 : train_test_split(x,y,test_size=0.3, random_state=1)
- 모델링
    - 회귀, 분류 먼저 선택 → 이에 따라 알고리즘과 평가방법이 달라짐
        1. 알고리즘과 평가방법 import
        2. 모델 선언 : model.LinearRegression() — 소괄호 중요 !!
        3. 학습하기 : model.fit(x_train, y_train)
        4. 예측하기 : y_pred=model.predict(x_test)
        5. 평가하기 : mean_absolute_error(y_test, y_pred)

# 머신러닝2

## 모델 성능 평가

### 분류 모델 성능 평가

- 분류모델 : 범주형 데이터 예측(0,1)
- 0을 1로 예측하거나 1을 0으로 예측할 수 있음
- 최빈값으로 예측하는 것보다 좋은 성능을 보여줘야 함
- 평가지표
    - Confusion Matrix
        
        ![image.png](images/0927/image.png)
        
        - TN, FP, FN, TP로 나누어짐
            - TN : 음성을 음성으로 예측
            - FP : 음성을 양성으로 예측
            - FN : 양성을 음성으로 예측
            - TP : 양성을 양성으로 예측
    - Accuracy : 전체에서 정확하게 예측한 (TP, TN) 값의 비율
        - $\large Accuracy = \frac{TP+TN}{TP+TN+FP+FN}$
    - Precision : **Positive(양성)으로 예측**한 값(TP, FP) 중 실제 Positive(양성)인 값(TP)의 비율 - 예측 관점
        - $\large Precision = \frac{TP}{TP+FP}$
    - Recall : **실제로 Positive(양성)인** 값(FN, TP) 중 Positive(양성)으로 예측한 값(TP)의 비율 - 실제 관점
        - $\large Recall = \frac{TP}{TP+FN}$
    - F1-Score : Precision과 Recall의 조화 평균
        - $\large F1 = \frac{2\times Precision\times Recall}{Precision+Recall}$

### 회귀 모델 성능 평가

- 회귀 모델 : 숫자 데이터 예측
- 예측값과 실제값 사이의 오차가 적어야 함
- 평균값보다 좋은 성능을 보여줘야 함
- 평가지표
    - MSE : Mean Squared Error
        - $\large MSE=\frac{1}{n}\sum_{i=1}^{n}(y_{i}-\hat{y}_{i})^2$
    - RMSE : Root Mean Squared Error
        - $\large RMSE=\sqrt{\frac{1}{n}\sum_{i=1}^{n}(y_{i}-\hat{y}_{i})^2}$
    - MAE : Mean Absolute Error
        - $\large MAE=\frac{1}{n}\sum_{i=1}^{n}|y_{i}-\hat{y}_{i}|$
    - MAPE : Mean Absolute Percentage Error
        - $\large MAPE=\frac{1}{n}\sum_{i=1}^{n}\left |\frac{y_{i}-\hat{y}_{i}}{y_{i}}\right |$

## 실습 : 분류 및 회귀 모델 성능 평가

- 평가 지표를 metrics에서 import 해서 y_test, y_pred을 넣어서 실행하면 됨