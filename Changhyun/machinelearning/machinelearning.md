# 머신러닝
데이터를 이용해 모델을 학습하고, 그 모델을 기반으로 새로운 데이터를 예측하거나 분류하는 등의 작업을 수행할 수 있도록하는 메커니즘.

명시적으로 써주지 않고도, 데이터를 보고 알아서 의사결정 및 예측을 할 수 있도록 한다.

## 학습 방법에 따른 분류

- **지도 학습 (Supervised Learning)**
  - 학습 대상이 되는 데이터에 정답을 주어 규칙성, 즉 데이터의 패턴을 배우게 하는 학습 방법

- **비지도 학습 (Unsupervised Learning)**
  - 정답이 없는 데이터만으로 배우게 하는 학습 방법

- **강화 학습 (Reinforcement Learning)**
  - 선택한 결과에 대해 보상을 받아 행동을 개선하면서 배우게 하는 학습 방법

---

## 과제에 따른 분류

- **분류 문제 (Classification)**
  - 이미 적절히 분류된 데이터를 학습하여 분류 규칙을 찾고, 그 규칙을 기반으로 새롭게 주어진 데이터를 적절히 분류하는 것을 목적으로 함 (**지도 학습**)

- **회귀 문제 (Regression)**
  - 이미 결과값이 있는 데이터를 학습하여 입력 값과 결과 값의 연관성을 찾고, 그 연관성을 기반으로 새롭게 주어진 데이터에 대한 값을 예측하는 것을 목적으로 함 (**지도 학습**)

- **클러스터링 (Clustering)**
  - 주어진 데이터를 학습하여 적절한 분류 규칙을 찾아 데이터를 분류함을 목적으로 함. 정답이 없으니 성능을 평가하기 어려움 (**비지도 학습**)


## 분류와 회귀

**회귀 (Regression)**는 연속적인 숫자를 예측하는 것이고, **분류 (Classification)**는 범주값을 예측하는 것이다.

- 연속적인 숫자 확인 방법
    -   두 값 사이에 중간값이 의미가 있는 숫자인지 확인합니다.
    -   또는 두 값에 대한 연산 결과가 의미가 있는 숫자인지 등을 확인.
- 구분 방법
    -   예측해야 할 값에 연속성이 있는지 확인하면, 분류와 회귀를 구분 가능.
    -   즉, 회귀는 수치형 데이터에 대한 예측을 하고, 분류는 특정 카테고리나 그룹에 대한 예측을 수행한다.

## sklearn을 이용한 대략의 학습 과정
1. 불러오기
    - 사용할 알고리즘과 평가를 위한 함수를 **import**

2. 선언하기
    - 사용할 알고리즘용 함수로 모델 선언

3. 학습하기
    - 모델을 `(x_train, y_train)` 형태로 모델 학습 시키기

4. 예측하기
    - 모델의 `predict(x_test)` 형태로 예측한 결과를 변수로 저장

5. 평가하기
    - 실젯값과 예측값을 평가 함수에 전달해 성능 평가


## 학습 후의 평가
1. 분류 모델 평가
    - 분류 모델은 0인지 1인지를 예측하는 것
      - 실제 값도 0과 1이고 예측 값도 0과 1임
      - 하지만 0을 1로 예측하거나 1을 0으로 예측할 수 있음
      - 예측 값이 실제 값과 많이 같을수록 좋은 모델이라 할 수 있음
      - **정확히 예측한 비율**로 모델 성능을 평가
    - **평가지표**
        - **혼동행렬과 평가지표**

        |               | Predicted Negative (0) | Predicted Positive (1) |
        |---------------|-------------------------|-------------------------|
        | **Actual Negative (0)** | True Negative (TN)       | False Positive (FP)      |
        | **Actual Positive (1)** | False Negative (FN)      | True Positive (TP)       |

        - **정확도 (Accuracy)**: 전체 예측 중에서 맞게 예측한 비율
          \[
          Accuracy = \frac{TN + TP}{TN + FP + FN + TP}
          \]

        - **정밀도 (Precision)**: Positive로 예측한 것 중 실제로 Positive인 비율
          \[
          Precision = \frac{TP}{FP + TP}
          \]

        - **재현율 (Recall)**: 실제 Positive 중에서 Positive로 예측한 비율.
          \[
          Recall = \frac{TP}{FN + TP}
          \]
            - 이때 Recall은 *Sensitivity**라는 이름으로도 불리움.
            - positive를 맞추는 것이 acc보다 훨 중요한 경우가 많아서 특히 민감한 지표이기 때문.
            - 예를 들어, 우리나라의 기상예보는 매일 "맑은 날씨"라고 이야기할때보다 정확도가 낮음.
                그러나 정말 중요한건 정확도가 아니라, 비오는 날이 언젠지를 더 잘 맞추는 것임.
        - **특이도 (Specificity)** :실제 Negative (TN + FP) 중에서 Negative로 예측한 비율 (TN)
          - 예) 실제 비가 내리지 않은 날 중에서 비가 내리지 않을 것으로 예측한 날의 비율

        - **특이도가 낮을 경우 발생하는 문제**:
          - 비가 오지 않는데 비가 온다고 했으니 불필요한 우산을 챙기는 수고 발생
          - 암이 아닌데 암이라고 했으니 불필요한 치료 발생
          - positive를 어디로 보느냐에 따라 recall과 Specificity로 나뉨.
        - **수식**:
          \[
          Specificity = \frac{TN}{TN + FP}
          \]
        
        - 정밀도와 재현율은 기본적으로 Positive에 대해 이야기함.
        - Negative에 대한 정밀도와 재현율도 의미를 가질 수 있음.


2. 회귀 모델 평가
    - 회귀 모델이 정확한 값을 예측하기는 사실상 어려움
      - 예측 값과 실제 값에 **차이(=오차)**가 존재할 것이라 예상함
      - 예측 값이 실제 값에 가까울수록 좋은 모델이라 할 수 있음
      - **예측한 값과 실제 값의 차이(=오차)**로 모델 성능을 평가
    - **평가지표**

        - **MSE (Mean Squared Error)**: 평균 제곱 오차
          - 실제 값과 예측 값의 차이를 제곱하여 평균낸 값
          - $$ MSE = \frac{\sum (y - \hat{y})^2}{n} $$

        - **RMSE (Root Mean Squared Error)**: 평균 제곱근 오차
          - MSE의 제곱근을 구한 값. 실제 오차의 크기를 원래 단위로 표현
          - $$ RMSE = \sqrt{\frac{\sum (y - \hat{y})^2}{n}} $$

        - **MAE (Mean Absolute Error)**: 평균 절대 오차
          - 실제 값과 예측 값의 차이의 절댓값을 평균낸 값
          - $$ MAE = \frac{\sum |y - \hat{y}|}{n} $$

        - **MAPE (Mean Absolute Percentage Error)**: 평균 절대 백분율 오차
          - 실제 값과 예측 값의 차이를 백분울로 나타내 평균낸 값
          - $$ MAPE = \frac{\sum \left| \frac{y - \hat{y}}{y} \right|}{n} $$

    - **결정 계수 \( R^2 \) (R-Squared)**
        - 모델 성능을 잘 해석하기 위해서 만든 MSE의 표준화된 버전이 결정 계수임
        - **전체 오차 중에서 회귀식이 잡아낸 오차 비율**(일반적으로 0 ~ 1 사이)
        - 오차의 비 또는 설명력이라고도 부름
        - \( R^2 = 1 \)이면 \( MSE = 0 \)이고 모델이 데이터를 완벽하게 학습한 것이라고 볼 수 있음. (과적함임 이건.)


